

# wiki.js - inboc

wiki.js

[Xie Jian 已更新 大约 2 小时前](https://outline.inboc.net/doc/wikijs-eTp5zj2OAg/history)  • [被浏览 2 用户](https://outline.inboc.net/doc/wikijs-eTp5zj2OAg/insights)

1、在 Wiki.js 中，导航至管理界面中的 "Authentication "部分。添加 `Generic OpenID Connect / OAuth2` 策略，并在底部的 `Configuration Reference` 部分注明回调 URL / 重定向 URI。

2、在 authentik 中的 Providers 下，使用这些设置创建一个 OAuth2/OpenID Provider：

*   Redirect URIs/Origins： 您在上一步中注意到的回调 URL / 重定向 URI。
    
*   Signing Key：选择任何可用密钥
    

注意 Client ID 和 Client Secret，然后保存提供程序。如果需要检索这些值，可以通过编辑提供程序来实现。

3、创建 Provider

![](assets/1713432807-8debf32eb8142499b083e4767be2c18b.png)

4、在 Wiki.js 中，使用这些设置配置身份验证策略：

*   Client ID：来自 authentik 提供商的客户 ID。
    
*   Client Secret：authentik 提供商提供的客户密文。
    
*   Authorization Endpoint URL: [https://authentik.company/application/o/authorize/](https://authentik.company/application/o/authorize/)
    
*   Token Endpoint URL: [https://authentik.company/application/o/token/](https://authentik.company/application/o/token/)
    
*   User Info Endpoint URL: [https://authentik.company/application/o/userinfo/](https://authentik.company/application/o/userinfo/)
    
*   Issuer: [https://authentik.company/application/o/wikijs/](https://authentik.company/application/o/wikijs/)
    
*   Logout URL: [https://authentik.company/application/o/wikijs/end-session/](https://authentik.company/application/o/wikijs/end-session/)
    
*   Allow self-registration: Enabled
    
*   Assign to group：应将从 authentik 登录的新用户分配到哪个组。
    

![](assets/1713432807-2a39e651d957c15e36238b3ca8c734c7.png)

注意: 你不必启用 "允许自助注册"，也不必选择新用户应被分配到的组，但如果你不这样做，就必须在 Wiki.js 中手动配置用户，并确保他们的电子邮件与 authentik 中的电子邮件一致。

注意: 如果您使用自签名证书进行授权，则需要通过设置 NODE\_EXTRA\_CA\_CERTS 变量，将 CA 的根证书设置为 WikiJS 中受信任的证书，具体操作如下：[https://github.com/Requarks/wiki/discussions/3387。](https://github.com/Requarks/wiki/discussions/3387%E3%80%82)

5、在 authentik 中，创建一个使用该Provider的Application。可选择使用Policy绑定对应用程序应用访问限制。

将启动 URL 设置为回调 URL / 重定向 URI，末尾不含 `/callback` ，如下所示。这将跳过 Wiki.js 的登录提示，直接登录。

![](assets/1713432807-abf2f03f9fc8aef07597c78b9abdd0f9.png)

[反向链接](#backlinks)

[7\. 项目配置](https://outline.inboc.net/doc/7-Y6TGY95RO9#d-eTp5zj2OAg)
